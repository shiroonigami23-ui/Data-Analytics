function doPost(e){try{var data=JSON.parse(e.postData.contents);var name=data.name||'Anonymous';var email=data.email||'';var msg=data.message||'';var files=data.files||[];var ss=SpreadsheetApp.openById('YOUR_SHEET_ID');var sheet=ss.getSheetByName('Feedback')||ss.insertSheet('Feedback');if(sheet.getLastRow()==0){sheet.appendRow(['Timestamp','Name','Email','Message','Files'])}var fileLinks=[];var folder=DriveApp.getFoldersByName('DataAnalyticsHub_Uploads').hasNext()?DriveApp.getFoldersByName('DataAnalyticsHub_Uploads').next():DriveApp.createFolder('DataAnalyticsHub_Uploads');for(var i=0;i<files.length;i++){var f=files[i];var blob=Utilities.newBlob(Utilities.base64Decode(f.content), f.type, f.name);var uploaded=folder.createFile(blob);fileLinks.push(uploaded.getUrl())}sheet.appendRow([new Date(),name,email,msg,fileLinks.join(', ')]);if(email)MailApp.sendEmail({to:email,subject:'ðŸŽ‰ Thanks for sharing with Data Analytics Hub!',htmlBody:'ðŸ“Šâœ¨ <b>Data Analytics Hub</b> âœ¨ðŸ“Š<br><br>Hey '+(name||'Student')+',<br><br>Thanks for your feedback! We received:\\n<em>'+msg+'</em><br><br>We appreciate you ðŸš€<br><br>â€“ Data Analytics Hub (powered by Shiro Oni-sama)'});MailApp.sendEmail('aryansingh19gh@gmail.com','ðŸ“¬ New Feedback Received','Name: '+name+'\\nEmail: '+email+'\\nMessage: '+msg+'\\nFiles: '+fileLinks.join(', '));return ContentService.createTextOutput(JSON.stringify({status:'success'})).setMimeType(ContentService.MimeType.JSON);}catch(err){return ContentService.createTextOutput(JSON.stringify({status:'error',message:err.toString()})).setMimeType(ContentService.MimeType.JSON);}}
function sendDailySummary(){var ss=SpreadsheetApp.openById('YOUR_SHEET_ID');var sheet=ss.getSheetByName('Feedback');if(!sheet){return}var data=sheet.getDataRange().getValues();var today=new Date();today.setHours(0,0,0,0);var body='Greetings, Shiro Oni-sama ðŸ«¡\\n\\nToday\\'s Feedback Summary:\\n\\n';var count=0;for(var i=1;i<data.length;i++){var row=new Date(data[i][0]);if(row>=today){count++;body+= (i)+'. '+(data[i][1]||'Anonymous')+' ('+(data[i][2]||'No email')+') - '+(data[i][3]||'')+'\\nFiles: '+(data[i][4]||'None')+'\\n\\n'}}body+='Total submissions today: '+count;MailApp.sendEmail('aryansingh19gh@gmail.com','ðŸ“¬ Daily Feedback Summary â€“ Data Analytics Hub',body);}